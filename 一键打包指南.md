# 🎁 火宝一键漫剧 - 一键打包指南

## 📦 打包方案

我们提供了多种打包方案，适合不同的分发场景：

### 方案 1: 便携版打包（推荐）⭐

**适用场景**: 
- Windows 用户快速使用
- 无需安装，解压即用
- 适合网盘分发、U盘携带

**打包命令**:
```bash
build-portable.cmd
```

**输出文件**:
- `huobao-drama-v1.0.6-comfyui-windows-x64.zip` (约 50-100 MB)
- 包含完整的可执行文件、前端、配置

**使用方法**:
1. 解压 ZIP 文件
2. 双击 `启动.cmd`
3. 浏览器访问 http://localhost:5678

---

### 方案 2: Docker 镜像打包

**适用场景**:
- 跨平台部署
- 服务器环境
- 容器化分发

**打包命令**:
```bash
build-docker-image.cmd
```

**输出文件**:
- `huobao-drama-v1.0.6-comfyui-docker.tar` (约 200-300 MB)

**使用方法**:
```bash
# 导入镜像
docker load -i huobao-drama-v1.0.6-comfyui-docker.tar

# 运行容器
docker run -d -p 5678:5678 huobao-drama:v1.0.6-comfyui
```

---

### 方案 3: 源码打包

**适用场景**:
- 开发者使用
- 需要自定义修改
- 学习研究

**打包命令**:
```bash
git archive --format=zip --output=huobao-drama-source.zip HEAD
```

**输出文件**:
- `huobao-drama-source.zip` (约 10-20 MB)

---

## 🚀 快速打包流程

### Windows 便携版（最简单）

```bash
# 1. 进入项目目录
cd 火宝一键漫剧/huobao-drama

# 2. 运行打包脚本
build-portable.cmd

# 3. 等待完成，获得 ZIP 文件
# 输出: huobao-drama-v1.0.6-comfyui-windows-x64.zip
```

### Docker 镜像

```bash
# 1. 确保 Docker 已安装并运行
docker --version

# 2. 运行打包脚本
build-docker-image.cmd

# 3. 获得 TAR 文件
# 输出: huobao-drama-v1.0.6-comfyui-docker.tar
```

---

## 📋 打包前检查清单

### 必需环境

**便携版打包**:
- [x] Go 1.23+ 已安装
- [x] Node.js 18+ 已安装
- [x] npm 已安装

**Docker 镜像打包**:
- [x] Docker 已安装并运行

### 代码检查

- [ ] 代码已提交到 Git
- [ ] 前端可以正常构建 (`cd web && npm run build`)
- [ ] 后端可以正常编译 (`go build`)
- [ ] 配置文件已更新 (`configs/config.example.yaml`)

---

## 📁 打包内容

### 便携版包含

```
huobao-drama-portable/
├── huobao-drama.exe          # 主程序
├── 启动.cmd                   # 启动脚本
├── 停止.cmd                   # 停止脚本
├── 使用说明.md                # 使用文档
├── README-CN.md              # 项目文档
├── LICENSE                   # 许可证
├── web/                      # 前端文件
│   └── dist/
├── configs/                  # 配置文件
│   └── config.yaml
├── migrations/               # 数据库迁移
├── data/                     # 数据目录
│   └── storage/
└── workflows/                # 工作流目录
    ├── .gitkeep
    └── README.md
```

### Docker 镜像包含

- 完整的运行时环境
- Alpine Linux 基础镜像
- FFmpeg 视频处理工具
- 所有依赖库

---

## 🎯 分发建议

### 网盘分发

**推荐平台**:
- 百度网盘
- 阿里云盘
- 蓝奏云（小文件）

**分发文件**:
- `huobao-drama-v1.0.6-comfyui-windows-x64.zip`
- 附带 `使用说明.md`

### GitHub Release

1. 创建 Release: https://github.com/ops120/huobao-drama-comfyui/releases/new
2. 标签: `v1.0.6-comfyui`
3. 上传文件:
   - Windows 便携版 ZIP
   - Docker 镜像 TAR
   - 源码 ZIP

### 直接下载

将文件上传到：
- 自己的服务器
- 对象存储（OSS、COS）
- CDN 加速

---

## 🔧 高级打包选项

### 自定义版本号

编辑打包脚本，修改 `VERSION` 变量：
```batch
set VERSION=v1.0.7-custom
```

### 包含示例数据

在打包脚本中添加：
```batch
REM 复制示例数据
copy example-data\*.* %BUILD_DIR%\data\
```

### 多平台打包

**Linux 版本**:
```bash
GOOS=linux GOARCH=amd64 go build -o huobao-drama-linux
```

**macOS 版本**:
```bash
GOOS=darwin GOARCH=amd64 go build -o huobao-drama-macos
```

---

## 📊 打包文件大小参考

| 打包方式 | 文件大小 | 压缩后 |
|---------|---------|--------|
| 便携版 ZIP | 80-120 MB | 50-80 MB |
| Docker TAR | 250-350 MB | 200-300 MB |
| 源码 ZIP | 15-25 MB | 10-20 MB |

---

## ❓ 常见问题

### Q: 打包后文件太大怎么办？

A: 可以：
1. 使用 UPX 压缩可执行文件
2. 删除不必要的文档
3. 使用 7z 高压缩率

### Q: 如何减小 Docker 镜像大小？

A: 已使用多阶段构建和 Alpine 基础镜像，已经很小了。

### Q: 可以打包成安装包吗？

A: 可以使用 Inno Setup 或 NSIS 创建安装程序，但便携版更简单。

### Q: 如何自动化打包？

A: 可以使用 GitHub Actions 自动构建和发布。

---

## 📧 获取帮助

如有问题：
- 查看 [README-CN.md](README-CN.md)
- 提交 [Issue](https://github.com/ops120/huobao-drama-comfyui/issues)
- 发送邮件至 [18550175439@163.com](mailto:18550175439@163.com)

---

<div align="center">

**开始打包**: 运行 `build-portable.cmd`  
**推荐方案**: Windows 便携版  

Made with ❤️ by Huobao Team

</div>
